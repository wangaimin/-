# 《架构整洁之道》读书笔记

## 第1章 设计与架构究竟是什么
1. 软件架构的终极目标是，用最小的人力成本来满足构建和维护系统需求
## 第2章 两个价值维度
1. 对于软件系统，我们通过行为和架构来体现他的价值。
 - 行为价值：实现的功能
 - 架构：软件的灵活性
2. 构建一个灵活性高的软件，比短时间内能实现需求更为重要
3. 软件开发人员应当在保证软件架构的前提下去完成紧急的需求
4. 软件架构师的职责：构建出易于开发、修改简单、扩展轻松的架构
## 第3章 编程范式总览
1. 结构化编程
2. 面向对象编程
3. 函数式编程
## 第4章 结构化编程
1. 结构化编程范式促使我们将一段程序递归降解为一系列可证明的小函数，然后再编写相关测试用例来证明这些函数是错误的。若无法证明这些函数是错误的，那么我们认为这些函数是足够正确的，进而推导整个程序是正确的。
2. 在架构设计领域，功能性降解拆分是非常重要的
## 第5章 面向对象编程
1. 面向对象编程的核心本职是对多态的运用，利用多态的特性对代码中依赖关系进行控制。这种能力让软件架构师可以构建出某种插件式架构，让高层策略性组将与底层实现性组件进行分离，底层组件可以被编译成插件，实现独立于高层组件的开发与部署。
2. 多态是同一个行为拥有不同表现形式或形态的能力。多态的表现形式包括虚函数的重写、接口实现、抽象方法等。
## 第6章 函数式编程
1. TODO:
## 第7章 SRP:单一职责原则
1. 任何一个软件模块都应该只对某一类行为者负责。
2. 例如合同订单中的下单接口，API和页面调用的Service应该分开，保证职责单一。DA层只是单纯做新增则可重用。出现过一次修改页面下单Service，导致API下单报错线上事故，获取创建人是从上下文中获取的，导致API接口获取不到创建人，API接口没有上下文，是直接在InUserSysNo中赋值。
## 第8章 OCP：开闭原则
1. 设计良好的软件应该易于扩展，同时抗拒修改。主要目标是让系统易于扩展，限制每次修改所影响的范围。
2. 实现方式是把系统拆分为一系列组件，并且将这些组件的依赖关系按层次结构进行组织，使得上层组件不会因为低阶组件的修改而受到影响。
## 第9章 LSP:里氏替换原则
1. 主要表达实现类有可替换性，即对接口的合理使用。
## 第10章 ISP:接口隔离原则
1. 不要依赖程序不要的东西。一但所依赖的东西有所修改都可能会影响到主程序。
## 第11章 DIP:依赖反转原则
1. 如果想要设计一个灵活的系统，在源代码层次的依赖关系中应该多引用抽象，而非具体实现。
## 第12章 组件
1. 可独立部署的最小实体
## 第13章 组件聚合
TODO:
## 第14章 组件耦合
1. 组件依赖关系图中不应该出现环
2. 在依赖图中没有环装结构图则称这种图为**有向无环图（DAG）**
3. 消除循环依赖有两种方式：
   1. 依赖反转。若存在循环依赖A>B>C>D>B，可在B中定义接口，C实现接口，则依赖关系变为A>B<C
   2. 共同依赖一个新组件，这也是**spring**框架中**控制反转(IOC)** 的就是使用此方法。若存在循环依赖A>B>C>D>B，可定义新组件E，让B和C同时依赖E,则依赖关系变为A>B>E<C
4. 稳定依赖原则（SDP）：依赖关系必须时指向更稳定的方向。通过遵守稳定依赖原则，我们可以确保自己的设计中那些容易变更的模块不会被难以修改的模块依赖。
5. 稳定抽象原则（SAP）：一个组件的抽象化程度应该与其稳定性保持一致。一个稳定的组件应该是抽象的，一个不稳定的组件应该包含实现代码，这样便于修改。
6. 一个好的组件一定是由抽象类/接口、实现方法组成，需要保持其中的平衡。全为接口则无用，应该包含部分实现。
## 第15章 什么是软件架构
1. 软件架构这项工作的实质就是规划如何将系统拆分为组件，并安排组件之间的排序关系，以及组件之间相互通信的方式。
2. 设计软件架构的目的是为了在工作中更好的对这些组件进行研发、部署、运行以及维护。
## 第16章 独立性
1. 按层解耦：
   1. 可以通过采用单一职责原则（SRP）和共同闭包原则（CCP）以及既定的系统设计意图来隔离那些变更原因不同的部分，集成变更原因相同的部分。
   2. 一个系统可以被解耦成若干个系统分层：UI界面、应用独有的业务逻辑、领域普适的业务逻辑、数据库
## 第17章 划分边界
1. 为了在软件架构中划分边界，我们需要将系统拆分为组件，其中一部分是系统的核心业务逻辑组件，一部分时非核心业务逻辑组件但是是需要提供必要功能的插件，通过依赖反转原则（DIP）和稳定抽象原则（SAP）的运用让非核心功能插件依赖核心组件。例如UI层需要依赖业务逻辑层，但UI层可作为插件可随意切换为WEB、移动端、客户端等，数据的存储同样如此，核心逻辑并不关系数据存储在数据库或文件，只要具体实现类去实现核心逻辑定义的借口即可。
## 第18章 边界剖析
1. 一个按照服务划分边界的系统也可能会在某一部分采用本地进程的边界划分模式。
